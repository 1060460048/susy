// Breakpoint Integration Tests
// ============================

// Tests
@include test-module('breakpoint integration') {
  @include test('[mixin] susy-breakpoint') {
    $layout: 24 .5 static;

    $test: susy-get(columns);
    $expect: susy-get(columns, $layout);
    @include assert-unequal($test, $expect,
      'Assert that we arent testing the default layout');

    @include susy-breakpoint(720px, $layout) {
      $test: susy-get(columns);
      @include assert-equal($test, $expect,
        'Susy-breakpoint creates a new global layout context');
    }
  }

  @include output-test('susy-breakpoint') {
    @include assert-setup('susy-breakpoint') {
      .test,
      .expect {
        width: 100%;
      }
    }

    @include assert-output(
      'Creates a custom media-query around any content block.'
    ) {
      .test {
        @include susy-breakpoint(35em, 8 .25 inside, '.foo') {
          @include span(4);
        }
      }

      .expect {
        @media (min-width: 35em) {
          -moz-box-sizing: border-box;
          -webkit-box-sizing: border-box;
          box-sizing: border-box;
          width: 50%;
          float: left;
          padding-left: 1.25%;
          padding-right: 1.25%;
        }

        .foo & {
          -moz-box-sizing: border-box;
          -webkit-box-sizing: border-box;
          box-sizing: border-box;
          width: 50%;
          float: left;
          padding-left: 1.25%;
          padding-right: 1.25%;
        }
      }
    }
  }

  @include output-test('susy-mq') {
    @include assert-setup('susy-mq') {
      .test,
      .expect {
        width: 100%;
      }
    }

    @include assert-output(
      'Creates a custom media-query around any content block.'
    ) {
      .test {
        @include susy-mq(35em, '.foo') {
          width: 50%;
        }
      }

      .expect {
        @media (min-width: 35em) {
          width: 50%;
        }

        .foo & {
          width: 50%;
        }
      }
    }
  }

  @include test('[function] susy-get-media') {
    $susy-breakpoints: (large: 60em) !global;

    $test: susy-get-media(large);
    $expect: 60em;
    @include assert-equal($test, $expect,
      'Returns $susy-breakpoint values based on key name.');
  }

  @include test('[function] susy-parse-breakpoint') {
    $test: susy-parse-breakpoint(35em);
    $expect: (
      min-width: 35em,
      max-width: null,
    );
    @include assert-equal($test, $expect,
      'Returns a simple length as min-width query.');

    $test: susy-parse-breakpoint(400px 800px);
    $expect: (
      min-width: 400px,
      max-width: 800px,
    );
    @include assert-equal($test, $expect,
      'Returns two length as min and max-width queries.');

    $test: susy-parse-breakpoint(max-width 800px max-height 20em);
    $expect: (
      min-width: null,
      max-width: 800px,
      max-height: 20em,
    );
    @include assert-equal($test, $expect,
      'Returns implicit string/number pairs as custom queries.');

    $test: susy-parse-breakpoint((max-width 800px) (max-height 20em));
    $expect: (
      min-width: null,
      max-width: 800px,
      max-height: 20em,
    );
    @include assert-equal($test, $expect,
      'Returns explicit list pairs as custom queries.');

    $test: susy-parse-breakpoint((max-width: 800px, max-height: 20em));
    $expect: (
      max-width: 800px,
      max-height: 20em,
    );
    @include assert-equal($test, $expect,
      'Returns a map as custom queries.');

    $susy-breakpoints: (large: 60em) !global;

    $test: susy-parse-breakpoint(large);
    $expect: (
      min-width: 60em,
      max-width: null,
    );
    @include assert-equal($test, $expect,
      'Returns a named media-query after parsing it.');
  }

  @include test('susy-build-breakpoint') {
    $test: susy-build-breakpoint((
              min-width: 30em,
              max-width: null,
            ));
    $expect: '(min-width: 30em)';
    @include assert-equal($test, $expect,
      'Returns a usable query string based on a map (ignoring null values).');

  }
}
