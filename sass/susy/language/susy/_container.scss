// Container Syntax
// ================

// Container [mixin]
// -----------------
// Set a container element
// - [$grid]  : <settings>
@mixin container(
  $grid: get-grid()
) {
  $grid                   : get-adjusted-grid($grid);

  $this-container         : get-setting(container, $grid);
  $this-column-width      : get-setting(column-width, $grid);
  $this-columns           : get-setting(columns, $grid);
  $this-gutters           : get-setting(gutters, $grid);
  $this-gutter-type       : get-setting(gutter-type, $grid);
  $this-gutter-flow       : get-setting(gutter-flow, $grid);
  $this-layout-math       : get-setting(layout-math, $grid);

  $width      : get-container-width($this-container, $this-column-width, $this-columns, $this-gutters, $this-gutter-type, $this-gutter-flow);
  $justify    : get-setting(container-position, $grid);
  $box        : get-setting(box-sizing, $grid);

  @if $box {
    @include box-sizing($box);
  }

  @include float-container($width, $justify, $this-layout-math);
  @include grid-background($grid);
}

// Container [function]
// --------------------
// Return container width
// - [$grid]  : <settings>
@function container(
  $grid: get-grid()
) {
  $grid                   : get-adjusted-grid($grid);

  $this-container         : get-setting(container, $grid);
  $this-column-width      : get-setting(column-width, $grid);
  $this-columns           : get-setting(columns, $grid);
  $this-gutters           : get-setting(gutters, $grid);
  $this-gutter-type       : get-setting(gutter-type, $grid);
  $this-gutter-flow       : get-setting(gutter-flow, $grid);

  $width: get-container-width($this-container, $this-column-width, $this-columns, $this-gutters, $this-gutter-type, $this-gutter-flow);

  @return $width;
}

// Get Container Width
// -------------------
// Calculate the container width
// - [$container]         : <length> | false
// - [$column-width]      : <length> | false
// - [$columns]           : <columns>
// - [$gutters]           : <ratio>
// - [$gutter-flow]       : outside | inside
@function get-container-width(
  $container        : $container,
  $column-width     : $column-width,
  $columns          : $columns,
  $gutters          : $gutters,
  $gutter-type      : $gutter-type,
  $gutter-flow      : $gutter-flow
) {
  $width: $container;

  @if not $width or $width == auto {
    @if $column-width {
      $outer: if($gutter-flow == split and $gutter-type == inside, true, false);
      $width: calculate-container-width($columns, $gutters, $column-width, $outer);
    } @else {
      // if we have nothing, default to 100%
      $width: 100%;
    }
  }

  @return $width;
}
