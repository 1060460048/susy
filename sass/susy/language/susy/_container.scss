// Container Syntax
// ================

// Container [mixin]
// -----------------
// Set a container element
// - [$grid]  : <settings>
@mixin container(
  $grid
) {
  $pre                : $grid;
  $grid               : parse-grid($grid);

  $container          : susy-get(container, $grid);
  $column-width       : susy-get(column-width, $grid);
  $columns            : susy-get(columns, $grid);
  $gutters            : susy-get(gutters, $grid);
  $gutter-position    : susy-get(gutter-position, $grid);
  $layout-math        : susy-get(layout-math, $grid);

  $width      : get-container-width($container, $column-width, $columns, $gutters, $gutter-position);
  $justify    : susy-get(container-position, $grid);
  $box        : susy-get(box-sizing, $grid);

  @if $box {
    @include box-sizing($box);
  }

  @include float-container($width, $justify, $layout-math);
  @include background-grid($pre);
}

// Container [function]
// --------------------
// Return container width
// - [$grid]  : <settings>
@function container(
  $grid
) {
  $grid               : parse-grid($grid);

  $container          : susy-get(container, $grid);
  $column-width       : susy-get(column-width, $grid);
  $columns            : susy-get(columns, $grid);
  $gutters            : susy-get(gutters, $grid);
  $gutter-position    : susy-get(gutter-position, $grid);

  $width: get-container-width($container, $column-width, $columns, $gutters, $gutter-position);

  @return $width;
}

// Get Container Width
// -------------------
// Calculate the container width
// - [$container]         : <length> | false
// - [$column-width]      : <length> | false
// - [$columns]           : <columns>
// - [$gutters]           : <ratio>
// - [$gutter-position]   : before | after | split | inside
@function get-container-width(
  $container        : susy-get(container),
  $column-width     : susy-get(column-width),
  $columns          : susy-get(columns),
  $gutters          : susy-get(gutters),
  $gutter-position  : susy-get(gutter-position)
) {
  $width: $container;

  @if not $width or $width == auto {
    @if $column-width {
      $outer: if($gutter-position == inside, true, false);
      $width: calculate-container-width($columns, $gutters, $column-width, $outer);
    } @else {
      // if we have nothing, default to 100%
      $width: 100%;
    }
  }

  @return $width;
}
