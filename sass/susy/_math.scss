// ---------------------------------------------------------------------------
// Global math variables
// this is the language that is passed into the math functions, not nessisarily user-facing.

$context: 960px, 100%, 40em !default;
$columns: 12 !default;
$gutter: 10px !default;
$margin: 10px !default;

// ---------------------------------------------------------------------------
// Helper functions

// Find column count
@function column-count($columns) {
  @if type-of($columns) == number {
    @return $columns;
  }
  @if type-of($columns) == list {
    @return length($columns);
  }
}

// Query where things are in a string.
@function query-list($list, $query, $mode: none) {
  // blank list
  $return: ();
  // loop through list
  @for $i from 1 through length($list) {
    @if $mode == unit {
      // if the list item matches the query, write where it is to the list.
      @if unit(nth($list, $i)) == $query {
        $return: append($return, $i);
      }
    }
    @else {
      // if the list item matches the query, write where it is to the list.
      @if nth(nth($list, $i), 1) == $query {
        $return: append($return, $i);
      }
    }
  }
  // if nothing matches then return false.
  @if $return == () {
    $return: false;
  }

  // return list.
  @return $return;
}

// Find the sum of lists
@function list-sum($list) {
  $sum: 0;
  @each $item in $list {
    $sum: $sum + $item;
  }
  @return $sum;
}

// Find context
@function find-context($columns, $guter, $margin) {

  // If auto columns exist, context needs to be calculated.
  @if query-list($columns, auto) != false or length(columns) == 1 {
    @return nth($context, nth(query-list($context, unit($gutter), unit), 1));
  }
  @else {

    // Find sum of columns
    $column-sum: list-sum($columns);

    // Find sum of gutters
    $gutter-sum: $gutter * (column-count($columns) - 1);

    // Find sum of margin
    $margin-sum: list-sum($margin);
    @if type-of($margin) == number {
      $margin-sum: $margin * 2;
    }

    @return $column-sum + $gutter-sum + $margin-sum;
  }
}
