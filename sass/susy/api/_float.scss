// ---------
// Float API

// Relative Span
@mixin float-span-relative(
  $span,
  $location: false,
  $columns: $columns,
  $gutters: $gutters,
  $isolate: false
) {
  $gutter: relative-gutter-span($columns, $gutters);

  width: relative-column-span($span, $location, $columns, $gutters);

  @if $isolate {
    float: left;
    $push: get-location-position($span, $location, $columns) - 1;
    @if $push > 0 {
      margin-left: relative-column-span($push, 1, $columns, $gutters) + $gutter;
    }
    margin-right: -100%;
  } @else {
    @if is-last($span,$location,$columns) {
      float: right;
    } @else {
      float: left;
      margin-right: $gutter;
    }
  }
}

// Last Unit
@mixin float-last(
  $columns: $columns,
  $gutters: $gutters
) {
  float: right;
  margin-right: 0;
}

// Isolation Override
@mixin isolate(
  $location,
  $columns: $columns,
  $gutters: $gutters
) {
  $push: relative-column-span($location - 1, 1, $columns, $gutters) + relative-gutter-span($columns, $gutters);
  margin-right: -100%;
  margin-left: $push;
}

// Isolate Grid
@mixin isolate-grid(
  $span,
  $columns: $columns,
  $gutters: $gutters,
  $selector: 'child'
) {
  $location: 1;
  $context: column-count($columns);
  $line: floor($context / $span);

  @for $item from 1 through $line {
    $nth: '#{$line}n + #{$item}';
    &:#{format-nth($nth,$selector)} {
      @include float-span-relative($span, $location, $columns, $gutters, true);
      @if $location == 1 { clear: left; }

      $location: $location + $span;
      @if $location > $context { $location: 1; }
    }
  }
}
