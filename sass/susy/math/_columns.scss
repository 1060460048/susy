// -----------
// Column math

// Returns true if a grid is symmetrical
@function is-symmetrical(
  $columns: $columns
) {
  @if length($columns) == 1 {
    @return nth($columns,1);
  } @else {
    @return null;
  }
}

// Find the number of columns in a given layout
@function column-count(
  $columns: $columns
) {
  @if is-symmetrical($columns) {
    @return is-symmetrical($columns);
  } @else {
    @return length($columns);
  }
}

// Find the total sum of column-units in a layout
@function column-sum(
  $columns: $columns,
  $gutters: $gutters
) {
  $column-sum: 0;
  $gutter-sum: 0;

  @if column-count($columns) > 1 {
    $gutter-sum: (column-count($columns) - 1) * $gutters;
  }

  @if is-symmetrical($columns) {
    $column-sum: is-symmetrical($columns);
  } @else {
    @each $column in $columns {
      $column-sum: $column-sum + $column;
    }
  }

  @return $column-sum + $gutter-sum;
}

// Return a subset of columns at a given location
@function get-columns(
  $span,
  $location,
  $columns: $columns
) {
  $location     : get-location-position($span, $location, $columns);
  $sub-columns  : ();

  @if is-symmetrical($columns) {
    $sub-columns: nth($span,1);
  } @else {
    $location: if($location, $location, 1);

    @for $i from $location to ($location + $span) {
      $sub-columns: append($sub-columns, nth($columns, $i));
    }
  }

  @return $sub-columns;
}

// Find relative width of the column span
@function relative-column-span(
  $span,
  $location : false,
  $columns  : $columns,
  $gutters  : $gutters
) {
  $span-sum : false;
  $context  : column-sum($columns, $gutters);

  @if is-symmetrical($columns) {
    $span-sum: column-sum($span, $gutters);
  } @else {
    $span-columns: get-columns($span, $location, $columns);
    $span-sum: column-sum($span-columns, $gutters);
  }

  @return percentage($span-sum / $context);
}

// Find static width of the column span
@function static-column-span(
  $span,
  $location     : false,
  $columns      : $columns,
  $gutters      : $gutters,
  $column-width : $column-width
) {
  $span-sum : false;

  @if is-symmetrical($columns) {
    $span-sum: column-sum($span, $gutters);
  } @else {
    $span-columns: get-columns($span, $location, $columns);
    $span-sum: column-sum($span-columns, $gutters);
  }

  @return $span-sum * $column-width;
}
